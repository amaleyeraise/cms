$WebURL = "https://eyeraise.sharepoint.com/sites/POCDEMO"
 
#Get the Web Object
$Web= Get-SPWeb $WebURL
 
#Variables for Save site as template settings
$TemplateName ="DEMO Site Template"
$TemplateTitle ="DEMO Project Site Template"
$TemplateDescription ="Site template for DEMO project management portal"
 
#Option to Save with content
$SaveWithContent= 1  #0 otherwise
 
#Save site as template programmatically with PowerShell
$Web.SaveAsTemplate($TemplateName,$TemplateTitle,$TemplateDescription,$SaveWithContent)




#Load SharePoint CSOM Assemblies
Add-Type -Path "C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\16\ISAPI\Microsoft.SharePoint.Client.dll"
Add-Type -Path "C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\16\ISAPI\Microsoft.SharePoint.Client.Runtime.dll"
    
#Config Parameters
$SiteURL= "https://eyeraise.sharepoint.com/sites/POCDEMO"
#$SiteURL= "https://nturr.sharepoint.com/sites/pwa/PROJECTSITETEMPLATE"

#Setup Credentials to connect
$Cred = Get-Credential
$Cred = New-Object Microsoft.SharePoint.Client.SharePointOnlineCredentials($Cred.UserName,$Cred.Password)
  
    #Setup the context
    $Ctx = New-Object Microsoft.SharePoint.Client.ClientContext($SiteURL)
    $Ctx.Credentials = $Cred
  
   #Get the web and List
   #$Web=$Ctx.Web
   #$Web= Get-SPWeb $WebURL
   $Web= Get-SPWeb
    
#Variables for Save site as template settings
$TemplateName ="DEMO Site Template"
$TemplateTitle ="DEMO Project Site Template"
$TemplateDescription ="Site template for DEMO project management portal"
 
#Option to Save with content
$SaveWithContent= 1  #0 otherwise
 
#Save site as template programmatically with PowerShell
$Web.SaveAsTemplate($TemplateName,$TemplateTitle,$TemplateDescription,$SaveWithContent)
